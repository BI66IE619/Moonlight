<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Moonlight | Proxy Hub</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="proxy.css">
</head>
<body class="proxy-page">
    <canvas id="starfield"></canvas>

    <div class="ui-wrapper">
        <nav class="top-nav">
    <div class="nav-logo" onclick="window.location.href='main.html'" style="cursor:pointer">M // BACK</div>
    
    <div class="node-dropdown">
    <div class="dropdown-trigger" id="dropdown-trigger">
        <span class="status-dot"></span>
        <span id="current-node-label">SELECT_NODE</span>
        <span class="arrow">â–¼</span>
    </div>
    <div class="dropdown-content" id="proxy-menu">
        <div class="dropdown-item" data-id="1" data-name="INTEL_EDU">NODE_01: INTEL_EDU</div>
        <div class="dropdown-item" data-id="2" data-name="MATH_VM">NODE_02: MATH_VM</div>
        <div class="dropdown-item" data-id="3" data-name="NODE_03">NODE_03: [NEW_PROXY]</div>
        <div class="dropdown-item" data-id="4" data-name="NODE_04">NODE_04: [NEW_PROXY]</div>
    </div>
</div>

    <div class="nav-links">
        <span onclick="toggleFullscreen()" style="cursor:pointer; margin-right: 20px;">[ FULLSCREEN ]</span>
        <span class="nav-status">TUNNEL: <span id="active-node-name">STANDBY</span></span>
    </div>
</nav>

        <div class="window-container">
            <div class="window-header">
                <div class="status-indicator"></div>
                <span class="window-title">SECURE_TUNNEL // ENCRYPTED_FEED</span>
            </div>
            
            <div class="iframe-wrapper">
                <div id="loading-overlay">
                    <div class="spinner"></div>
                    <p id="load-text">ESTABLISHING ENCRYPTED LINK...</p>
                </div>
                <iframe id="proxy-frame" sandbox="allow-forms allow-scripts allow-same-origin allow-popups"></iframe>
            </div>
        </div>
    </div>

    <script src="script.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
    const trigger = document.getElementById('dropdown-trigger');
    const menu = document.getElementById('proxy-menu');
    
    // Define your proxy links here
    const nodes = {
        1: "https://intelleducation.netlify.app/",
        2: "https://vm.mathfilm.dk/",
        3: "https://your-proxy-3.com", 
        4: "https://your-proxy-4.com"
    };

    // 1. CLICK TO OPEN/CLOSE
    trigger.onclick = function(e) {
        e.stopPropagation(); // Prevents the window click from closing it immediately
        
        if (menu.style.display === "block") {
            menu.style.display = "none";
        } else {
            menu.style.display = "block";
        }
    };

    // 2. ITEM SELECTION
    document.querySelectorAll('.dropdown-item').forEach(item => {
        item.onclick = function() {
            const id = this.getAttribute('data-id');
            const name = this.getAttribute('data-name');
            const frame = document.getElementById('proxy-frame');
            const label = document.getElementById('current-node-label');
            const statusLabel = document.getElementById('active-node-name');
            const overlay = document.getElementById('loading-overlay');

            // Update UI Labels
            if(label) label.innerText = name;
            if(statusLabel) statusLabel.innerText = name;
            
            // Close Menu
            menu.style.display = "none";

            // Trigger Loading & Swap Source
            if (overlay) {
                overlay.style.display = 'flex';
                overlay.style.opacity = '1';
            }

            setTimeout(() => {
                if (frame) frame.src = nodes[id];
            }, 300);
        };
    });

    // 3. CLOSE IF CLICKING OUTSIDE
    window.onclick = function() {
        menu.style.display = "none";
    };
});
    </script>
</body>
</html>
